{"ast":null,"code":"import _slicedToArray from\"/home/forgeserver/Desktop/Forge-NFT-dAPP/defi-stake-yield-brownie-main/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from\"react\";import{useContractFunction,useEthers}from\"@usedapp/core\";import DC from\"../chain-info/DaughterContract.json\";import Erc20 from\"../chain-info/ERC20.json\";import{utils,constants}from\"ethers\";import{Contract}from\"@ethersproject/contracts\";import brownieConfig from\"../brownie-config-json.json\";import helperConfig from\"../helper-config.json\";/**\n * This hook is a bit messy but exposes a 'send' which makes two transactions.\n * The first transaction is to approve the ERC-20 token transfer on the token's contract.\n * Upon successful approval, a second transaction is initiated to execute the transfer by the TokenFarm contract.\n * The 'state' returned by this hook is the state of the first transaction until that has status \"Succeeded\".\n * After that it is the state of the second transaction.\n * @param tokenAddress - The token address of the token we wish to stake\n */export var useStakeTokens2=function useStakeTokens2(tokenAddress){var _useEthers=useEthers(),chainId=_useEthers.chainId,account=_useEthers.account;var abi=DC.abi;var networkName=chainId?helperConfig[chainId]:\"ganache\";var tokenFarmContractAddress=chainId?brownieConfig[\"networks\"][networkName][\"DappToken\"]:constants.AddressZero;var ForgeAddy=chainId?brownieConfig[\"networks\"][networkName][\"weth_token\"]:constants.AddressZero;var NFTBOOK=chainId?brownieConfig[\"networks\"][networkName][\"NFTBOOK\"]:constants.AddressZero;var tokenFarmInterface=new utils.Interface(abi);var tokenFarmContract=new Contract(NFTBOOK,tokenFarmInterface);var _useContractFunction=useContractFunction(tokenFarmContract,\"bidERC20\",{transactionName:\"Stake tokens\"}),stakeTokensSend=_useContractFunction.send,stakeTokensState=_useContractFunction.state;var erc20Interface=new utils.Interface(Erc20.abi);var tokenContract=new Contract(NFTBOOK,erc20Interface);var Forgecontract=new Contract(ForgeAddy,erc20Interface);var _useContractFunction2=useContractFunction(Forgecontract,\"approve\",{transactionName:\"Approve ERC20 transfer\"}),approveErc20Send=_useContractFunction2.send,approveErc20State=_useContractFunction2.state;var _useState=useState(\"0\"),_useState2=_slicedToArray(_useState,2),amountToStake=_useState2[0],setAmountToStake=_useState2[1];//var options = { value: amountToStake };\nuseEffect(function(){if(approveErc20State.status===\"Success\"){stakeTokensSend(account,\"2100000000000000000000000000000\");}// the dependency arry\n// the code inside the useEffect anytime\n// anything in this list changes\n// if you want something to run when the component first runs\n// you just have a blank list\n},[approveErc20State,amountToStake,tokenAddress]);// eslint-disable-line react-hooks/exhaustive-deps\nvar send=function send(amount){setAmountToStake(amount);return approveErc20Send(NFTBOOK,amount);};var _useState3=useState(approveErc20State),_useState4=_slicedToArray(_useState3,2),state=_useState4[0],setState=_useState4[1];useEffect(function(){if(approveErc20State.status===\"Success\"){setState(stakeTokensState);}else{setState(approveErc20State);}},[approveErc20State,stakeTokensState]);return{send:send,state:state};};","map":{"version":3,"sources":["/home/forgeserver/Desktop/Forge-NFT-dAPP/defi-stake-yield-brownie-main/front_end/src/hooks/useStakeTokens2.ts"],"names":["useEffect","useState","useContractFunction","useEthers","DC","Erc20","utils","constants","Contract","brownieConfig","helperConfig","useStakeTokens2","tokenAddress","chainId","account","abi","networkName","tokenFarmContractAddress","AddressZero","ForgeAddy","NFTBOOK","tokenFarmInterface","Interface","tokenFarmContract","transactionName","stakeTokensSend","send","stakeTokensState","state","erc20Interface","tokenContract","Forgecontract","approveErc20Send","approveErc20State","amountToStake","setAmountToStake","status","amount","setState"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\"\nimport { useContractFunction, useEthers } from \"@usedapp/core\"\nimport DC from \"../chain-info/DaughterContract.json\"\nimport Erc20 from \"../chain-info/ERC20.json\"\nimport { utils, constants } from \"ethers\"\nimport { Contract } from \"@ethersproject/contracts\"\n\nimport networkMapping from \"../chain-info/map.json\"\nimport brownieConfig from \"../brownie-config-json.json\"\nimport helperConfig from \"../helper-config.json\"\n/**\n * This hook is a bit messy but exposes a 'send' which makes two transactions.\n * The first transaction is to approve the ERC-20 token transfer on the token's contract.\n * Upon successful approval, a second transaction is initiated to execute the transfer by the TokenFarm contract.\n * The 'state' returned by this hook is the state of the first transaction until that has status \"Succeeded\".\n * After that it is the state of the second transaction.\n * @param tokenAddress - The token address of the token we wish to stake\n */\nexport const useStakeTokens2 = (tokenAddress: string) => {\n  const { chainId, account } = useEthers()\n  const { abi } = DC\n  const networkName = chainId ? helperConfig[chainId] : \"ganache\"\n  const tokenFarmContractAddress = chainId ? brownieConfig[\"networks\"][networkName][\"DappToken\"] : constants.AddressZero\n  const ForgeAddy = chainId ? brownieConfig[\"networks\"][networkName][\"weth_token\"] : constants.AddressZero\n  const NFTBOOK = chainId ? brownieConfig[\"networks\"][networkName][\"NFTBOOK\"] : constants.AddressZero\n  const tokenFarmInterface = new utils.Interface(abi)\n\n  const tokenFarmContract = new Contract(\n    NFTBOOK,\n    tokenFarmInterface\n  )\n  const { send: stakeTokensSend, state: stakeTokensState } =\n    useContractFunction(tokenFarmContract, \"bidERC20\", {\n      transactionName: \"Stake tokens\",\n    })\n\n  const erc20Interface = new utils.Interface(Erc20.abi)\n\n  const tokenContract = new Contract(NFTBOOK, erc20Interface)\n\n  const Forgecontract = new Contract(ForgeAddy, erc20Interface)\n\n  const { send: approveErc20Send, state: approveErc20State } =\n    useContractFunction(Forgecontract, \"approve\", {\n      transactionName: \"Approve ERC20 transfer\",\n    })\n\n  const [amountToStake, setAmountToStake] = useState(\"0\")\n\n  //var options = { value: amountToStake };\n  useEffect(() => {\n    if (approveErc20State.status === \"Success\") {\n      stakeTokensSend(account, \"2100000000000000000000000000000\")\n    }\n    // the dependency arry\n    // the code inside the useEffect anytime\n    // anything in this list changes\n    // if you want something to run when the component first runs\n    // you just have a blank list\n  }, [approveErc20State, amountToStake, tokenAddress]) // eslint-disable-line react-hooks/exhaustive-deps\n\n  const send = (amount: string) => {\n    setAmountToStake(amount)\n    return approveErc20Send(NFTBOOK, amount)\n  }\n\n  const [state, setState] = useState(approveErc20State)\n\n  useEffect(() => {\n    if (approveErc20State.status === \"Success\") {\n      setState(stakeTokensState)\n    } else {\n      setState(approveErc20State)\n    }\n  }, [approveErc20State, stakeTokensState])\n\n  return { send, state }\n}\n"]},"metadata":{},"sourceType":"module"}