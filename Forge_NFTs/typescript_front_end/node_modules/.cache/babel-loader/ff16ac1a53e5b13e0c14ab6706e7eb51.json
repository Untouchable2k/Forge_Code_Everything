{"ast":null,"code":"import _createForOfIteratorHelper from \"/home/forgeserver/Desktop/Forge-NFT-dAPP/defi-stake-yield-brownie-main/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport { useMemo } from 'react';\nimport { useNotificationsContext } from '../providers';\nimport { useEthers } from './useEthers';\nimport { useInterval } from './useInterval';\nimport { useConfig } from '../providers/config/context';\n\nfunction getExpiredNotifications(notifications, expirationPeriod) {\n  var timeFromCreation = function timeFromCreation(creationTime) {\n    return Date.now() - creationTime;\n  };\n\n  return notifications.filter(function (notification) {\n    return timeFromCreation(notification.submittedAt) >= expirationPeriod;\n  });\n}\n\nexport function useNotifications() {\n  var _useEthers = useEthers(),\n      chainId = _useEthers.chainId,\n      account = _useEthers.account;\n\n  var _useNotificationsCont = useNotificationsContext(),\n      addNotification = _useNotificationsCont.addNotification,\n      notifications = _useNotificationsCont.notifications,\n      removeNotification = _useNotificationsCont.removeNotification;\n\n  var _useConfig = useConfig(),\n      _useConfig$notificati = _useConfig.notifications,\n      checkInterval = _useConfig$notificati.checkInterval,\n      expirationPeriod = _useConfig$notificati.expirationPeriod;\n\n  var chainNotifications = useMemo(function () {\n    var _a;\n\n    if (chainId === undefined || !account) {\n      return [];\n    }\n\n    return (_a = notifications[chainId]) !== null && _a !== void 0 ? _a : [];\n  }, [notifications, chainId, account]);\n  useInterval(function () {\n    if (!chainId) {\n      return;\n    }\n\n    var expiredNotification = getExpiredNotifications(chainNotifications, expirationPeriod);\n\n    var _iterator = _createForOfIteratorHelper(expiredNotification),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var notification = _step.value;\n        removeNotification({\n          notificationId: notification.id,\n          chainId: chainId\n        });\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n  }, checkInterval);\n  return {\n    notifications: chainNotifications,\n    addNotification: addNotification,\n    removeNotification: removeNotification\n  };\n}","map":{"version":3,"sources":["../../../../src/hooks/useNotifications.ts"],"names":[],"mappings":";AAAA,SAAS,OAAT,QAAwB,OAAxB;AACA,SAAuB,uBAAvB,QAAsD,cAAtD;AACA,SAAS,SAAT,QAA0B,aAA1B;AACA,SAAS,WAAT,QAA4B,eAA5B;AACA,SAAS,SAAT,QAA0B,6BAA1B;;AAEA,SAAS,uBAAT,CAAiC,aAAjC,EAAgE,gBAAhE,EAAwF;AACtF,MAAM,gBAAgB,GAAG,SAAnB,gBAAmB,CAAC,YAAD;AAAA,WAA0B,IAAI,CAAC,GAAL,KAAa,YAAvC;AAAA,GAAzB;;AAEA,SAAO,aAAa,CAAC,MAAd,CAAqB,UAAC,YAAD;AAAA,WAAkB,gBAAgB,CAAC,YAAY,CAAC,WAAd,CAAhB,IAA8C,gBAAhE;AAAA,GAArB,CAAP;AACD;;AAED,OAAM,SAAU,gBAAV,GAA0B;AAC9B,mBAA6B,SAAS,EAAtC;AAAA,MAAQ,OAAR,cAAQ,OAAR;AAAA,MAAiB,OAAjB,cAAiB,OAAjB;;AACA,8BAA+D,uBAAuB,EAAtF;AAAA,MAAQ,eAAR,yBAAQ,eAAR;AAAA,MAAyB,aAAzB,yBAAyB,aAAzB;AAAA,MAAwC,kBAAxC,yBAAwC,kBAAxC;;AACA,mBAEI,SAAS,EAFb;AAAA,yCACE,aADF;AAAA,MACmB,aADnB,yBACmB,aADnB;AAAA,MACkC,gBADlC,yBACkC,gBADlC;;AAIA,MAAM,kBAAkB,GAAG,OAAO,CAAC,YAAK;;;AACtC,QAAI,OAAO,KAAK,SAAZ,IAAyB,CAAC,OAA9B,EAAuC;AACrC,aAAO,EAAP;AACD;;AACD,WAAA,CAAA,EAAA,GAAO,aAAa,CAAC,OAAD,CAApB,MAA6B,IAA7B,IAA6B,EAAA,KAAA,KAAA,CAA7B,GAA6B,EAA7B,GAAiC,EAAjC;AACD,GALiC,EAK/B,CAAC,aAAD,EAAgB,OAAhB,EAAyB,OAAzB,CAL+B,CAAlC;AAOA,EAAA,WAAW,CAAC,YAAK;AACf,QAAI,CAAC,OAAL,EAAc;AACZ;AACD;;AAED,QAAM,mBAAmB,GAAG,uBAAuB,CAAC,kBAAD,EAAqB,gBAArB,CAAnD;;AALe,+CAMY,mBANZ;AAAA;;AAAA;AAMf,0DAAgD;AAAA,YAArC,YAAqC;AAC9C,QAAA,kBAAkB,CAAC;AAAE,UAAA,cAAc,EAAE,YAAY,CAAC,EAA/B;AAAmC,UAAA,OAAO,EAAP;AAAnC,SAAD,CAAlB;AACD;AARc;AAAA;AAAA;AAAA;AAAA;AAShB,GATU,EASR,aATQ,CAAX;AAWA,SAAO;AACL,IAAA,aAAa,EAAE,kBADV;AAEL,IAAA,eAAe,EAAf,eAFK;AAGL,IAAA,kBAAkB,EAAlB;AAHK,GAAP;AAKD","sourceRoot":"","sourcesContent":["import { useMemo } from 'react';\nimport { useNotificationsContext } from '../providers';\nimport { useEthers } from './useEthers';\nimport { useInterval } from './useInterval';\nimport { useConfig } from '../providers/config/context';\nfunction getExpiredNotifications(notifications, expirationPeriod) {\n    const timeFromCreation = (creationTime) => Date.now() - creationTime;\n    return notifications.filter((notification) => timeFromCreation(notification.submittedAt) >= expirationPeriod);\n}\nexport function useNotifications() {\n    const { chainId, account } = useEthers();\n    const { addNotification, notifications, removeNotification } = useNotificationsContext();\n    const { notifications: { checkInterval, expirationPeriod }, } = useConfig();\n    const chainNotifications = useMemo(() => {\n        var _a;\n        if (chainId === undefined || !account) {\n            return [];\n        }\n        return (_a = notifications[chainId]) !== null && _a !== void 0 ? _a : [];\n    }, [notifications, chainId, account]);\n    useInterval(() => {\n        if (!chainId) {\n            return;\n        }\n        const expiredNotification = getExpiredNotifications(chainNotifications, expirationPeriod);\n        for (const notification of expiredNotification) {\n            removeNotification({ notificationId: notification.id, chainId });\n        }\n    }, checkInterval);\n    return {\n        notifications: chainNotifications,\n        addNotification,\n        removeNotification,\n    };\n}\n//# sourceMappingURL=useNotifications.js.map"]},"metadata":{},"sourceType":"module"}